<!doctype html><html><head><title>数据同步配置 · Apache ShenYu</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="zh"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link style=font-size:25px;margin-right:50px href=/zh/><img class=logo src=/img/logo/apache-shenyu.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/zh/projects/shenyu/download/><span>下载</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/zh/projects/shenyu/overview/><span>文档</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/zh/community/subscribe-email/><span>社区</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/zh/news/><span>新闻</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/zh/awesome/><span>Awesome</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/shenyu/use-data-sync/><span>English</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/zh/projects/shenyu/download/>下载</a>
<a class=navbar-item href=/zh/projects/shenyu/overview/>文档</a>
<a class=navbar-item href=/zh/community/subscribe-email/>社区</a>
<a class=navbar-item href=/zh/news/>新闻</a>
<a class=navbar-item href=/zh/awesome/>Awesome</a>
<span class="navbar-item nav-hover"><a>Links</a><div class=dropdown-menu><a class=dropdown-item href=https://www.apache.org/>Apache Software Foundation</a>
<a class=dropdown-item href=https://github.com/apache/incubator-shenyu/issues>GitHub Issue Tracker</a>
<a class=dropdown-item href=https://www.apache.org/>License</a>
<a class=dropdown-item href=http://www.apache.org/events/current-event>Apache Events</a>
<a class=dropdown-item href=https://www.apache.org/licenses/>Security</a>
<a class=dropdown-item href=http://www.apache.org/foundation/sponsorship.html>Sponsor and Donate</a>
<a class=dropdown-item href=http://www.apache.org/foundation/thanks.html>Thanks</a></div></span></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/shenyu/use-data-sync/>En</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title="Apache ShenYu是一个异步的，高性能的，跨语言的，响应式的API网关。">Apache ShenYu(current)<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>主要项目</h4><ul class=list><li class=item><a href=/zh/projects/shenyu/overview>Apache ShenYu(current)</a></li><li class=item><a href=/zh/projects/shenyu-2.3.0/overview>Apache ShenYu(2.3.0)</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class=link><a title=介绍 href=/zh/projects/shenyu/overview>介绍</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=设计文档>设计文档</a></div><ul class=leaf-section><li class=item><div class=link><a title=Admin数据结构 href=/zh/projects/shenyu/database-design>Admin数据结构</a></div></li><li class=item><div class=link><a title=数据同步原理 href=/zh/projects/shenyu/data-sync>数据同步原理</a></div></li><li class=item><div class=link><a title=客户端接入原理 href=/zh/projects/shenyu/register-center-design>客户端接入原理</a></div></li><li class=item><div class=link><a title=流量控制 href=/zh/projects/shenyu/flow-control>流量控制</a></div></li><li class=item><div class=link><a title=SPI扩展设计 href=/zh/projects/shenyu/spi-design>SPI扩展设计</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=运维部署>运维部署</a></div><ul class=leaf-section><li class=item><div class=link><a title=本地部署 href=/zh/projects/shenyu/deployment-local>本地部署</a></div></li><li class=item><div class=link><a title=二进制包部署 href=/zh/projects/shenyu/deployment-package>二进制包部署</a></div></li><li class=item><div class=link><a title=Docker部署 href=/zh/projects/shenyu/deployment-docker>Docker部署</a></div></li><li class=item><div class=link><a title=Kubernetes部署 href=/zh/projects/shenyu/deployment-k8s>Kubernetes部署</a></div></li><li class=item><div class=link><a title=Helm部署 href=/zh/projects/shenyu/deployment-helm>Helm部署</a></div></li><li class=item><div class=link><a title=自定义部署 href=/zh/projects/shenyu/deployment-custom>自定义部署</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=快速开始>快速开始</a></div><ul class=leaf-section><li class=item><div class=link><a title=Http代理 href=/zh/projects/shenyu/quick-start-http>Http代理</a></div></li><li class=item><div class=link><a title=Dubbo代理 href=/zh/projects/shenyu/quick-start-dubbo>Dubbo代理</a></div></li><li class=item><div class=link><a title="Spring Cloud代理" href=/zh/projects/shenyu/quick-start-springcloud>Spring Cloud代理</a></div></li><li class=item><div class=link><a title=Sofa代理 href=/zh/projects/shenyu/quick-start-sofa>Sofa代理</a></div></li><li class=item><div class=link><a title=gRPC代理 href=/zh/projects/shenyu/quick-start-grpc>gRPC代理</a></div></li><li class=item><div class=link><a title=Tars代理 href=/zh/projects/shenyu/quick-start-tars>Tars代理</a></div></li><li class=item><div class=link><a title=Motan代理 href=/zh/projects/shenyu/quick-start-motan>Motan代理</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=用户文档>用户文档</a></div><ul class=leaf-section><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=admin使用>admin使用</a></div><ul class=leaf-section><li class=item><div class=link><a title=插件管理 href=/zh/projects/shenyu/plugin-handle-explanation>插件管理</a></div></li><li class=item><div class=link><a title=选择器和规则管理 href=/zh/projects/shenyu/selector-and-rule>选择器和规则管理</a></div></li><li class=item><div class=link><a title=字典管理 href=/zh/projects/shenyu/dictionary-management>字典管理</a></div></li><li class=item><div class=link><a title=权限管理 href=/zh/projects/shenyu/authority-management>权限管理</a></div></li></ul></li><li class=item><div class="link -current"><a title=数据同步配置 href=/zh/projects/shenyu/use-data-sync>数据同步配置</a></div></li><li class=item><div class=link><a title=客户端接入配置 href=/zh/projects/shenyu/register-center-access>客户端接入配置</a></div></li><li class=item><div class=link><a title=Http服务接入 href=/zh/projects/shenyu/http-proxy>Http服务接入</a></div></li><li class=item><div class=link><a title=Dubbo服务接入 href=/zh/projects/shenyu/dubbo-proxy>Dubbo服务接入</a></div></li><li class=item><div class=link><a title="Spring Cloud服务接入" href=/zh/projects/shenyu/spring-cloud-proxy>Spring Cloud服务接入</a></div></li><li class=item><div class=link><a title=Sofa服务接入 href=/zh/projects/shenyu/sofa-rpc-proxy>Sofa服务接入</a></div></li><li class=item><div class=link><a title=gRPC服务接入 href=/zh/projects/shenyu/grpc-proxy>gRPC服务接入</a></div></li><li class=item><div class=link><a title=Tars服务接入 href=/zh/projects/shenyu/tars-proxy>Tars服务接入</a></div></li><li class=item><div class=link><a title=Motan服务接入 href=/zh/projects/shenyu/motan-proxy>Motan服务接入</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=插件集合>插件集合</a></div><ul class=leaf-section><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Http 处理">Http 处理</a></div><ul class=leaf-section><li class=item><div class=link><a title=Rewrite插件 href=/zh/projects/shenyu/rewrite-plugin>Rewrite插件</a></div></li><li class=item><div class=link><a title=Redirect插件 href=/zh/projects/shenyu/redirect-plugin>Redirect插件</a></div></li><li class=item><div class=link><a title=Request插件 href=/zh/projects/shenyu/request-plugin>Request插件</a></div></li><li class=item><div class=link><a title=Context-path插件 href=/zh/projects/shenyu/context-path-plugin>Context-path插件</a></div></li><li class=item><div class=link><a title=Param-mapping插件 href=/zh/projects/shenyu/param-mapping-plugin>Param-mapping插件</a></div></li><li class=item><div class=link><a title=ModifyResponse插件 href=/zh/projects/shenyu/modify-response-plugin>ModifyResponse插件</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="RPC 代理">RPC 代理</a></div><ul class=leaf-section><li class=item><div class=link><a title=Divide插件 href=/zh/projects/shenyu/divide-plugin>Divide插件</a></div></li><li class=item><div class=link><a title=Dubbo插件 href=/zh/projects/shenyu/dubbo-plugin>Dubbo插件</a></div></li><li class=item><div class=link><a title="Spring Cloud插件" href=/zh/projects/shenyu/spring-cloud-plugin>Spring Cloud插件</a></div></li><li class=item><div class=link><a title=Sofa插件 href=/zh/projects/shenyu/sofa-plugin>Sofa插件</a></div></li><li class=item><div class=link><a title=gRPC插件 href=/zh/projects/shenyu/grpc-plugin>gRPC插件</a></div></li><li class=item><div class=link><a title=Tars插件 href=/zh/projects/shenyu/tars-plugin>Tars插件</a></div></li><li class=item><div class=link><a title=Motan插件 href=/zh/projects/shenyu/motan-plugin>Motan插件</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=熔断和限流>熔断和限流</a></div><ul class=leaf-section><li class=item><div class=link><a title=Hystrix插件 href=/zh/projects/shenyu/hystrix-plugin>Hystrix插件</a></div></li><li class=item><div class=link><a title=Sentinel插件 href=/zh/projects/shenyu/sentinel-plugin>Sentinel插件</a></div></li><li class=item><div class=link><a title=Resilience4j插件 href=/zh/projects/shenyu/resilience4j-plugin>Resilience4j插件</a></div></li><li class=item><div class=link><a title=RateLimiter插件 href=/zh/projects/shenyu/rate-limiter-plugin>RateLimiter插件</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=权限认证>权限认证</a></div><ul class=leaf-section><li class=item><div class=link><a title=Waf插件 href=/zh/projects/shenyu/waf-plugin>Waf插件</a></div></li><li class=item><div class=link><a title=Sign插件 href=/zh/projects/shenyu/sign-plugin>Sign插件</a></div></li><li class=item><div class=link><a title=JWT插件 href=/zh/projects/shenyu/jwt-plugin>JWT插件</a></div></li><li class=item><div class=link><a title="OAuth 2插件" href=/zh/projects/shenyu/oauth2-plugin>OAuth 2插件</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=可观测性>可观测性</a></div><ul class=leaf-section><li class=item><div class=link><a title=Monitor插件 href=/zh/projects/shenyu/monitor-plugin>Monitor插件</a></div></li><li class=item><div class=link><a title=Logging插件 href=/zh/projects/shenyu/logging-plugin>Logging插件</a></div></li></ul></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=开发者文档>开发者文档</a></div><ul class=leaf-section><li class=item><div class=link><a title=自定义Filter href=/zh/projects/shenyu/custom-filter>自定义Filter</a></div></li><li class=item><div class=link><a title=自定义插件 href=/zh/projects/shenyu/custom-plugin>自定义插件</a></div></li><li class=item><div class=link><a title=文件上传下载 href=/zh/projects/shenyu/file-and-image>文件上传下载</a></div></li><li class=item><div class=link><a title=自定义解析IP与Host href=/zh/projects/shenyu/custom-parsing-ip-and-host>自定义解析IP与Host</a></div></li><li class=item><div class=link><a title=自定义返回结果 href=/zh/projects/shenyu/custom-result>自定义返回结果</a></div></li><li class=item><div class=link><a title=自定义签名插件算法与验证 href=/zh/projects/shenyu/custom-sign-algorithm>自定义签名插件算法与验证</a></div></li><li class=item><div class=link><a title=自定义匹配条件策略 href=/zh/projects/shenyu/custom-condition-match>自定义匹配条件策略</a></div></li><li class=item><div class=link><a title=多语言Http客户端接入 href=/zh/projects/shenyu/developer-shenyu-client>多语言Http客户端接入</a></div></li><li class=item><div class=link><a title=线程模型 href=/zh/projects/shenyu/thread>线程模型</a></div></li><li class=item><div class=link><a title=ShenYu调优 href=/zh/projects/shenyu/shenyu-optimize>ShenYu调优</a></div></li></ul></li><li class=item><div class=link><a title=版本发布 href=/zh/projects/shenyu/release-notes>版本发布</a></div></li><li class=item><div class=link><a title=文档下载 href=/zh/projects/shenyu/download>文档下载</a></div></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>数据同步配置</h1><a class="edit-button -hidden-mobile" href=https://github.com/apache/incubator-shenyu-website/edit/main/content/zh/projects/shenyu/use-data-sync/index.md>编辑</a></div><div class=meta>更新时间: 2021-08-06</div></div><article class=typo><p>本篇主要讲解如何配置数据同步策略，数据同步是指在 <code>shenyu-admin</code> 后台操作数据以后，使用何种策略将数据同步到 <code>Apache ShenYu</code> 网关。<code>Apache ShenYu</code> 网关当前支持<code>ZooKeeper</code>、<code>WebSocket</code>、<code>Http长轮询</code>、<code>Nacos</code>、<code>Etcd</code> 和 <code>Consul</code>进行数据同步。</p><p><img src=/img/shenyu/dataSync/data-sync-2.png width=60% height=50%></p><p>数据同步原理请参考设计文档中的 <a href=../data-sync>数据同步原理</a> 。</p><h3 id=websocket同步配置-默认方式-推荐>WebSocket同步配置（默认方式，推荐）</h3><ul><li><p><code>Apache ShenYu</code>网关配置</p><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p></li></ul><pre><code class=language-xml>    &lt;!-- apache shenyu data sync start use websocket--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
        &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-websocket&lt;/artifactId&gt;
        &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-websocket-pom.png width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    websocket :
      urls: ws://localhost:9095/websocket
      # urls:是指 shenyu-admin的地址，如果有多个，请使用（,）分割。  
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-websocket-yml.png width=80% height=70%></p><ul><li><code>shenyu-admin 配置</code></li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yml>shenyu:
  sync:
    websocket:
      enabled: true
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-websocket-admin-yml.png width=80% height=70%></p><p>当建立连接以后会全量获取一次数据，以后的数据都是增量的更新与新增，性能好。而且也支持断线重连 （默认<code>30</code>秒）。推荐使用此方式进行数据同步，也是<code>Apache ShenYu</code>默认的数据同步策略。</p><h3 id=zookeeper同步配置>Zookeeper同步配置</h3><ul><li><p><code>Apache ShenYu</code>网关配置</p><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p></li></ul><pre><code class=language-xml>        &lt;!-- apache shenyu data sync start use zookeeper--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
            &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-zookeeper&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-zk-pom.png width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    zookeeper:
      url: localhost:2181
      # url: 配置成你的 zookeeper 地址，集群环境请使用（,）分隔
      sessionTimeout: 5000
      connectionTimeout: 2000
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-zk-yml.png width=80% height=70%></p><ul><li><code>shenyu-admin</code> 配置</li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    zookeeper:
      url: localhost:2181
      # url: 配置成你的 zookeeper 地址，集群环境请使用（,）分隔
      sessionTimeout: 5000
      connectionTimeout: 2000
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-admin-zk-yml.png width=80% height=70%></p><p>使用<code>zookeeper</code>同步机制也是非常好的，时效性也高，但是要处理<code>zookeeper</code>环境不稳定，集群脑裂等问题。</p><h3 id=http长轮询同步配置>Http长轮询同步配置</h3><ul><li><code>Apache ShenYu</code>网关配置</li></ul><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p><pre><code class=language-xml>        &lt;!-- apache shenyu data sync start use http--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
            &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-http&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-http-pom.png width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    http:
      url: http://localhost:9095
      # url: 配置成你的 shenyu-admin 的 ip 与端口地址，多个admin集群环境请使用（,）分隔。
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-http-yml.png width=80% height=70%></p><ul><li><code>shenyu-admin</code> 配置</li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    http:
      enabled: true
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-admin-http-yml.png width=80% height=70%></p><p>使用<code>Http长轮询</code>进行数据同步，会让网关很轻量，但时效性略低。它是根据分组<code>key</code>来拉取，如果数据量过大，过多，会有一定的影响。原因是一个组下面的一个小地方更改，都会拉取整个组的数据。</p><h3 id=nacos同步配置>Nacos同步配置</h3><ul><li><code>Apache ShenYu</code>网关配置</li></ul><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p><pre><code class=language-xml>        &lt;!-- apache shenyu data sync start use nacos--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
            &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-nacos&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-nacos-pom.png width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    nacos:
      url: localhost:8848
      # url: 配置成你的 nacos地址，集群环境请使用（,）分隔。
      namespace: 1c10d748-af86-43b9-8265-75f487d20c6c
      username:
      password:
      acm:
        enabled: false
        endpoint: acm.aliyun.com
        namespace:
        accessKey:
        secretKey:
      # 其他参数配置，请参考 naocs官网。
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-nacos-yml.png width=80% height=70%></p><ul><li><code>shenyu-admin</code> 配置</li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    nacos:
      url: localhost:8848
      # url: 配置成你的 nacos地址，集群环境请使用（,）分隔。
      namespace: 1c10d748-af86-43b9-8265-75f487d20c6c
      username:
      password:
      acm:
        enabled: false
        endpoint: acm.aliyun.com
        namespace:
        accessKey:
        secretKey:
      # 其他参数配置，请参考 naocs官网。
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-admin-nacos-yml.png width=80% height=70%></p><h3 id=etcd-同步配置>Etcd 同步配置</h3><ul><li><code>Apache ShenYu</code>网关配置</li></ul><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p><pre><code class=language-xml>        &lt;!-- apache shenyu data sync start use etcd--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
            &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-etcd&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;io.grpc&lt;/groupId&gt;
                    &lt;artifactId&gt;grpc-grpclb&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;io.grpc&lt;/groupId&gt;
                    &lt;artifactId&gt;grpc-netty&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-etcd-pom.png width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    etcd:
      url: http://localhost:2379
      # url: 配置成你的 etcd，集群环境请使用（,）分隔。
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-etcd-yml.png width=80% height=70%></p><ul><li><code>shenyu-admin</code> 配置</li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    etcd:
      url: http://localhost:2379
      # url: 配置成你的 etcd，集群环境请使用（,）分隔。
</code></pre><p><img src=/img/shenyu/dataSync/shenyu-data-sync-admin-etcd-yml.png width=80% height=70%></p><h3 id=consul-同步配置>Consul 同步配置</h3><ul><li><code>Apache ShenYu</code>网关配置</li></ul><p>首先在 <code>pom.xml</code> 文件中引入以下依赖：</p><pre><code class=language-xml>        &lt;!-- apache shenyu data sync start use consul--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shenyu&lt;/groupId&gt;
            &lt;artifactId&gt;shenyu-spring-boot-starter-sync-data-consul&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre><p><img src=/img/shenyu/dataSync/shenyu_consul_sync_gateway.jpg width=80% height=70%></p><p>然后在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    consul:
      url: http://localhost:8500
      waitTime: 1000    # 查询等待时间
      watchDelay: 1000  # 数据同步间隔时间
</code></pre><p><img src=/img/shenyu/dataSync/shenyu_consul_gateway_sync_config.jpg width=80% height=70%></p><ul><li><code>shenyu-admin</code> 配置</li></ul><p>在 <code>yml</code> 文件中进行如下配置:</p><pre><code class=language-yaml>shenyu:
  sync:
    consul:
      url: http://localhost:8500
</code></pre><p><img src=/img/shenyu/dataSync/shenyu_consul_admin_sync_config.jpg width=80% height=70%></p><blockquote><p>在<code>Apache ShenYu</code>网关和<code>shenyu-admin</code> 重新配置数据同步策略后，需要重启服务。</p><p><code>Apache ShenYu</code>网关 和 <code>shenyu-admin</code> 必须使用相同的同步策略。</p></blockquote></article></main></div><footer class=ss-footer><div class=container><div class=links><div class="cate  -show-mobile"><h2 class=cate-title>Apache</h2><a class=link href=https://www.apache.org/>Foundation</a>
<a class=link href=https://github.com/apache/incubator-shenyu/issues>GitHub Issue Tracker</a>
<a class=link href=https://www.apache.org/licenses/>License</a>
<a class=link href=https://www.apache.org/security/>Security</a>
<a class=link href=http://www.apache.org/events/current-event>Events</a>
<a class=link href=http://www.apache.org/foundation/sponsorship.html>Sponsorship</a>
<a class=link href=http://www.apache.org/foundation/thanks.html>Thanks</a></div><div class=cate><h2 class=cate-title>资源</h2><a class=link href=https://github.com/apache/incubator-shenyu>Github</a>
<a class=link href=/zh/projects/shenyu/overview/>文档</a></div><div class=cate><h2 class=cate-title>参与进来</h2><a class=link href=https://github.com/apache/incubator-shenyu/issues/new>反馈</a>
<a class=link href=/zh/community>社区</a>
<a class=link href=/zh/news>新闻</a></div><div class=cate><h2 class=cate-title>订阅邮件组</h2><a class=link href=/zh/community/subscribe-email/>如何订阅</a>
<a class=link href=mailto://dev-subscribe@shenyu.apache.org>订阅邮件</a>
<a class=link href=https://lists.apache.org/list.html?dev@shenyu.apache.org>邮件归档</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/WechatIMG127.jpeg><p class=qrcode-desc>微信公众号</p></div></div></div><div class=copyright><p>Copyright © 2021 The Apache Software Foundation. Licensed under the Apache License, Version 2.0.
Apache ShenYu, Apache Incubator, Apache, the Apache feather logo, the Apache ShenYu logo and the Apache Incubator project logo are trademarks of The Apache Software Foundation.
Apache ShenYu is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator.
Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects.
While incubation status is not necessarily a reflection of the completeness or stability of the code,
it does indicate that the project has yet to be fully endorsed by the ASF.</p></div></footer></body></html>