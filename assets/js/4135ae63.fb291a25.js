"use strict";(self.webpackChunkshenyu_website=self.webpackChunkshenyu_website||[]).push([[78125],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=i.createContext({}),u=function(e){var t=i.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return i.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},s=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),s=u(n),m=a,h=s["".concat(o,".").concat(m)]||s[m]||c[m]||r;return n?i.createElement(h,l(l({ref:t},d),{},{components:n})):i.createElement(h,l({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=s;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:a,l[1]=p;for(var u=2;u<r;u++)l[u]=n[u];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}s.displayName="MDXCreateElement"},49852:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return o},default:function(){return s},frontMatter:function(){return p},metadata:function(){return u},toc:function(){return d}});var i=n(87462),a=n(63366),r=(n(67294),n(3905)),l=["components"],p={title:"Divide Plugin",keywords:["divide"],description:"divide plugin"},o=void 0,u={unversionedId:"plugin-center/proxy/divide-plugin",id:"plugin-center/proxy/divide-plugin",isDocsHomePage:!1,title:"Divide Plugin",description:"divide plugin",source:"@site/docs/plugin-center/proxy/divide-plugin.md",sourceDirName:"plugin-center/proxy",slug:"/plugin-center/proxy/divide-plugin",permalink:"/docs/next/plugin-center/proxy/divide-plugin",editUrl:"https://github.com/apache/incubator-shenyu-website/edit/main/docs/plugin-center/proxy/divide-plugin.md",version:"current",frontMatter:{title:"Divide Plugin",keywords:["divide"],description:"divide plugin"},sidebar:"tutorialSidebar",previous:{title:"Rewrite Plugin",permalink:"/docs/next/plugin-center/http-process/rewrite-plugin"},next:{title:"Dubbo Plugin",permalink:"/docs/next/plugin-center/proxy/dubbo-plugin"}},d=[{value:"Explanation",id:"explanation",children:[]},{value:"Plugin Setting",id:"plugin-setting",children:[]},{value:"Plugin detail",id:"plugin-detail",children:[]}],c={toc:d};function s(e){var t=e.components,n=(0,a.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"explanation"},"Explanation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Divide")," is the core processing plugin for gateway to process ",(0,r.kt)("inlineCode",{parentName:"li"},"http")," requests.")),(0,r.kt)("h2",{id:"plugin-setting"},"Plugin Setting"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Add related dependencies and enable plugin, please refer to: ",(0,r.kt)("a",{parentName:"p",href:"../../quick-start/quick-start-http"},"Quick start with Http"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Http")," client access, please refer to\uff1a",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/http-proxy"},"Http proxy")," ."))),(0,r.kt)("h2",{id:"plugin-detail"},"Plugin detail"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"divide")," plugin is a plugin for forward proxying of ",(0,r.kt)("inlineCode",{parentName:"p"},"http"),". All requests of the ",(0,r.kt)("inlineCode",{parentName:"p"},"http")," type are called by the plugin for load balancing."),(0,r.kt)("img",{src:"/img/shenyu/plugin/divide/plugin-en.png",width:"80%",height:"80%"}),(0,r.kt)("p",null,"After the client connects to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Apache ShenYu")," gateway, it will automatically register the selector and rule information. For the selector and rule configuration, please refer to:",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/admin-usage/selector-and-rule"},"Selector And Rule"),"\u3002"),(0,r.kt)("h4",{id:"selector-handler"},"Selector Handler"),(0,r.kt)("img",{src:"/img/shenyu/plugin/divide/selector_en.png",width:"80%",height:"80%"}),(0,r.kt)("p",null,"Selector Handler, corresponding to the ",(0,r.kt)("inlineCode",{parentName:"p"},"handle")," field of ",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/admin-usage/selector-and-rule"},"Selector And Rule Config")," , it is the ",(0,r.kt)("inlineCode",{parentName:"p"},"http")," configuration that is actually called after the gateway matches the traffic. You can configure multiple and set the load The balance weight, the specific load balancing strategy, is specified in the rules. For more information, please refer to ",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/admin-usage/plugin-handle-explanation"},"Plugin handle management")," in Plugin Config."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"detailed processing setting\uff1a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"host"),": input ",(0,r.kt)("inlineCode",{parentName:"p"},"localhost"),",this field is ignored.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ip:port"),": ip and port, input your true service ",(0,r.kt)("inlineCode",{parentName:"p"},"ip")," + port here.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"protocol"),": ",(0,r.kt)("inlineCode",{parentName:"p"},"HTTP")," protocol, input ",(0,r.kt)("inlineCode",{parentName:"p"},"http://")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"https://"),", default is:",(0,r.kt)("inlineCode",{parentName:"p"},"http://")," .")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"startupTime"),": enabling the time.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"weight"),": load balancing weight.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"warmupTime"),": warm-up time.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"status"),": open or closed.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ip + port")," check"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"there will be a scheduled task in ",(0,r.kt)("inlineCode",{parentName:"p"},"shenyu-admin")," to scan the configured ",(0,r.kt)("inlineCode",{parentName:"p"},"ip")," port, if it is found offline, choose to delete the ",(0,r.kt)("inlineCode",{parentName:"p"},"ip + port"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"can be configured as follows:"))))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"shenyu:\n  register:\n    registerType: http \n    serverLists: \n    props:\n      sessionTimeout: 5000\n      connectionTimeout: 2000\n      checked: true  # default is true, set to false, no detection\n      zombieCheckTimes: 5\n      scheduledTime: 10 # timing detection interval, the default is 10 seconds\n\n")),(0,r.kt)("h4",{id:"rule-handler"},"Rule Handler"),(0,r.kt)("img",{src:"/img/shenyu/plugin/divide/rule_en.png",width:"80%",height:"80%"}),(0,r.kt)("p",null,"Rule Handler, corresponding to the ",(0,r.kt)("inlineCode",{parentName:"p"},"handle")," field of ",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/admin-usage/selector-and-rule"},"Selector And Rule Config"),". It is the processing rule that the gateway adopts after the final matching of the traffic is completed. For more information, please refer to ",(0,r.kt)("a",{parentName:"p",href:"../../user-guide/admin-usage/plugin-handle-explanation"},"Plugin handle management")," in Plugin Config."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"detailed processing setting\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"loadStrategy"),": if the ",(0,r.kt)("inlineCode",{parentName:"p"},"http")," client is a cluster, which load balancing strategy is adopted when the ",(0,r.kt)("inlineCode",{parentName:"p"},"Apache ShenYu")," gateway is called, currently supports ",(0,r.kt)("inlineCode",{parentName:"p"},"roundRobin"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"random")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"hash"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"retryCount"),": number of retries for calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"http")," client.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"timeout"),": timeout period for calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"http")," client.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"headerMaxSize"),": maximum value of the requested ",(0,r.kt)("inlineCode",{parentName:"p"},"header"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"requestMaxSize"),": maximum size of the request body.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"retryStrategy"),": supported since ",(0,r.kt)("inlineCode",{parentName:"p"},"2.4.3"),", the retry strategy ",(0,r.kt)("inlineCode",{parentName:"p"},"after failure"),", the default ",(0,r.kt)("inlineCode",{parentName:"p"},"current")," remains compatible with lower versions. "),(0,r.kt)("p",{parentName:"li"},"For example, there are 3 downstream services ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1111"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1112")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1113"),", assuming the first load balancing to ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1111")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"call failed"),". "),(0,r.kt)("p",{parentName:"li"},"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"current")," policy will continue to retry the call to ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1111"),"; "),(0,r.kt)("p",{parentName:"li"},"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"failover")," policy will retry the call to other services such as ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1112")," through the ",(0,r.kt)("inlineCode",{parentName:"p"},"loadStrategy"),", if it fails again at this time , call to ",(0,r.kt)("inlineCode",{parentName:"p"},"http:localhost:1113")," until no service is available."))))))}s.isMDXComponent=!0}}]);